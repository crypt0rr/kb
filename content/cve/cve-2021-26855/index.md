---
title : "CVE-2021-26855"
# pre : ' '
description : "CVE-2021-26855 - ProxyLogon - Vulnerability resulting in unauthenticated remote code execution through only port 443."
date : 2021-03-08T09:07:20+01:00
# hidden : true
# draft : true
weight : 0
# tags : ['']
---

## CVE-2021-26855 - ProxyLogon | CVE-2021-26857 | CVE-2021-26858 | CVE-2021-27065

ProxyLogon is the formally generic name for CVE-2021-26855, a vulnerability on Microsoft Exchange Server that allows an attacker bypassing the authentication and impersonating as the admin. We have also chained this bug with another post-auth arbitrary-file-write vulnerability, CVE-2021-27065, to get code execution. All affected components are vulnerable by default!

As a result, an unauthenticated attacker can execute arbitrary commands on Microsoft Exchange Server through an only opened 443 port!

Check if you are running the patched version [here](https://eightwone.com/references/versions-builds-dates/)

### Vulnerable Exchange versions

* Microsoft Exchange Server 2013
* Microsoft Exchange Server 2016
* Microsoft Exchange Server 2019

### Patches for specific Exchange CU versions

You will need to install the latest CU first to be compliant.

| Release date | Product | Impact | Severity | Article | Download | Details
| :--------: | :----------: | :----------: | :----------: | :----------: | :----------: | :-----------: |
Mar 2, 2021 | Microsoft Exchange Server 2016 Cumulative Update 18 | Remote Code Execution | Critical | [5000871](https://support.microsoft.com/help/5000871) | [Security Update](https://www.microsoft.com/download/details.aspx?familyid=192fa60f-664a-4f3e-b19f-e295135e469b) | [CVE-2021-26855](https://msrc.microsoft.com/update-guide/vulnerability/CVE-2021-26855)
Mar 2, 2021 | Microsoft Exchange Server 2019 Cumulative Update 7 | Remote Code Execution | Critical | [5000871](https://support.microsoft.com/help/5000871) | [Security Update](https://www.microsoft.com/download/details.aspx?familyid=2aadda14-b8aa-4370-a492-0a6818facce8) | [CVE-2021-26855](https://msrc.microsoft.com/update-guide/vulnerability/CVE-2021-26855)
Mar 2, 2021 | Microsoft Exchange Server 2013 Cumulative Update 23 | Remote Code Execution | Critical | [5000871](https://support.microsoft.com/help/5000871) | [Security Update](https://www.microsoft.com/download/details.aspx?familyid=1255ecd7-b187-4839-96c9-1fc5e05df7b6) | [CVE-2021-26855](https://msrc.microsoft.com/update-guide/vulnerability/CVE-2021-26855)
Mar 2, 2021 | Microsoft Exchange Server 2019 Cumulative Update 8 | Remote Code Execution | Critical | [5000871](https://support.microsoft.com/help/5000871) | [Security Update](https://www.microsoft.com/download/details.aspx?familyid=18c75641-e53d-4979-8d5e-29a80674e41f) | [CVE-2021-26855](https://msrc.microsoft.com/update-guide/vulnerability/CVE-2021-26855)
Mar 2, 2021 | Microsoft Exchange Server 2016 Cumulative Update 19 | Remote Code Execution | Critical | [5000871](https://support.microsoft.com/help/5000871) | [Security Update](https://www.microsoft.com/download/details.aspx?familyid=31211a48-0cef-462e-bb11-c36440f80bb3) | [CVE-2021-26855](https://msrc.microsoft.com/update-guide/vulnerability/CVE-2021-26855)

### Scanner

Nmap .NSE file is created by Microsoft and can be found [here](https://github.com/microsoft/CSS-Exchange/blob/main/Security/http-vuln-cve2021-26855.nse).

{{%attachments fa_icon_class="far fa-file-pdf" pattern=".*(nse)"/%}}

```plain
$ nmap -p 443 --script http-vuln-cve2021-26855 10.10.10.15

PORT    STATE SERVICE
443/tcp  open  https
| http-vuln-cve2021-26855:
|   VULNERABLE
|   Exchange Server SSRF Vulnerability
|     State: VULNERABLE
|     IDs:  CVE:CVE-2021-26855
|
|     Disclosure date: 2021-03-02
|     References:
|       http://aka.ms/exchangevulns

@args http-vuln-cve2021-26855.method The HTTP method for the request. The default method is "GET".
```

### Exploit

***TO BE CONTINUED***

### Remediation / log analysis / detection of already created webshells

### Running identification script from Microsoft

<https://github.com/microsoft/CSS-Exchange/raw/main/Security/Test-ProxyLogon.ps1>

```plain
Welcome to the Exchange Management Shell!

[PS] C:\Users\Johndo-adm>.\Test-ProxyLogon.ps1 -OutPath $home\desktop\logs

Do you want to run software from this untrusted publisher?
File C:\Users\Johndo-adm\Test-ProxyLogon.ps1 is published by CN=Microsoft Corporation, O=Microsoft Corporation,
 L=Redmond, S=Washington, C=US and is not trusted on your system. Only run scripts from trusted publishers.
[V] Never run  [D] Do not run  [R] Run once  [A] Always run  [?] Help (default is "D"): R
ProxyLogon Status: Exchange Server EXCH01
  
  Nothing suspicious detected
```

### Detection of already created webshells

Detect webshells dropped on Microsoft Exchange servers exploited through "proxylogon" group of vulnerabilites (CVE-2021-26855, CVE-2021-26857, CVE-2021-26858, CVE-2021-27065)

<https://github.com/cert-lv/exchange_webshell_detection>  

### Microsoft Safety Scanner (MSERT)

Microsoft Safety Scanner is a scan tool designed to find and remove malware from Windows computers. Simply [download](https://docs.microsoft.com/en-us/windows/security/threat-protection/intelligence/safety-scanner-download) it and run a scan to find malware and try to reverse changes made by identified threats.

## URL List

* [Proxylogon.com](https://proxylogon.com/)
* [Msrc.microsoft.com - Microsoft Exchange Server Remote Code Execution Vulnerability - CVE-2021-26855](https://msrc.microsoft.com/update-guide/vulnerability/CVE-2021-26855)
* [Github.com - Microsoft test scripts](https://github.com/microsoft/CSS-Exchange/tree/main/Security)
* [Docs.microsoft.com - Microsoft Safety Scanner](https://docs.microsoft.com/en-us/windows/security/threat-protection/intelligence/safety-scanner-download)
* [Blog.cloudflare.com - Protecting against recently disclosed Microsoft Exchange Server vulnerabilities: CVE-2021-26855, CVE-2021-26857, CVE-2021-26858, and CVE-2021-27065](https://blog.cloudflare.com/protecting-against-microsoft-exchange-server-cves/)
* [Github.com - Detect webshells dropped on Microsoft Exchange servers after 0day compromises](https://github.com/cert-lv/exchange_webshell_detection)
* [Bleepingcomputer.com - This new Microsoft tool checks Exchange Servers for ProxyLogon hacks](https://www.bleepingcomputer.com/news/microsoft/this-new-microsoft-tool-checks-exchange-servers-for-proxylogon-hacks/)
* [nvd.nist.gov - CVE-2021-26855](https://nvd.nist.gov/vuln/detail/CVE-2021-26855)
